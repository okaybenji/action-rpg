## TODO

### Bug fixes
* there seems to be an issue in which newly connecting players cannot see other players until they have switched tabs away from the loaded page, then switch back. recall that last time something like this happened, it was because you were failing to wait for the game to load before spawning players. that was causing a phaser error about assets not yet being in cache, though. this issue is not causing an error. also, it works locally just fine.
* refactored logging code causes 'user-such-and-such connected' to be logged for every user each time a new user connects.
* Compensate for length of sword when player attacks west or north
* Eliminate bug which occasionally causes player animation to stick
* Eliminate occasional hiccup in position reconciliation (basically, make reconciliation work :/)

### Near-future features
* Interpolate player to server recon position
* Broadcast and interpolate positions of other players
* Consider allowing 360 degrees player rotation
* Allow players to attack each other
* Implement lag compensation. Rather than broadcasting player positions, broadcast input histories of players to each other and play them back at a constant 100ms in the past, interpolating between each input. On the server, store histories for each player until server knows what each player was doing at a given time (or an arbitrary fixed value of time has passed when the data is too old to matter anyway). If player A attacks player B, look to see where player B was positioned on player A's machine at the time of attack. If server happens to have input for player B at that moment, use the position calculated from that input. Otherwise, calculate the position from the time and the inputs stored from immediately before and after that time.
* Prompt player for username on connection and accept if not already taken
* Currently input sample and input history upload occur at the same rate of 6 times/sec. This is not likely to be a high enough rate for sampling in an action game where, for instance, a player may attack at any instant and for any duration. For one thing, some such attacks will happen between samples and thus never get logged or uploaded. Perhaps a better approach is to track the last time input was uploaded and check each sample how many samples we have recorded since that time. Once a threshold is hit, upload the history to the server. So the sample rate can be changed to something like 24 times per second, and the treshold of samples before uploading 4 (24 / 4 = 6 uploads per second).

### Eventual features
* Let client configure its samples per second and upload rate. Track this info on the server and accumulate responses, only sending them to client each upload (will no longer be able to use broadcast for movement).

### Miscellaneous
* Figure this out: If you sample input every input sample tick rather than only if the input has changed and keep the input sample tick at 25 times per second, when you move the player rightward or downward the server only reconciles at the beginning or ending of the movement and the movement is smooth, but if you move the player leftward or upward, reconciling happens every server tick and the movement is jerky. However, setting the input sample rate at 60 samples per second, movement is smooth in any direction. This seems to have something to do with the upload tick rate -- if the same rate is evenly divisible by the upload rate, less reconciliation is necessary. Amazingly, at 6 samples per second and 6 uploads per second, it seems reconciliation is never necessary. Anyway, what does direction of movement have to do with anything UPDATE: now (6-20-16) using Math.round to calculate position causes this weirdness, but it's ok otherwise.

## NOTES
* I *think* the The reason my original implementation of the network code wasn't working had to do with the input sample rate. Basically, the server could respond with an updated position in between samples, but after the player had moved some distance. The client would then instantly 'correct' the player's position according to the server's authority and try to apply any inputs sampled since. But since not enough time had passed to collect any input samples, the player just wound up back where he started. If that is indeed what was happening, I have a potential solution: store responses with corrected position from the server, and apply them the instant an input sample is captured! In this way, we can rely on fewer input samples. (Currently the sample rate is set at 60 and movement still isn't all that smooth. Could be smoothed out with interpolation maybe, but reverting back to a small sample rate will have other benefits such as reducing bandwidth and performance requirements.) Also! If this idea doesn't work, try sampling every update()! &shrug; UPDATE: Well, my idea worked, sort of. I thought I could sample and upload my sample 6 times per second, but that made the game unplayable again. However, sampling 30 times/sec and uploading every 5 samples seems to work ok! It's not great, but I can live with it for now. Note that while I was still rounding calculations to the nearest pixel I was still getting the weird issue in Miscellaneous above (up and left movement was jerky/sticky) so I stopped doing that.